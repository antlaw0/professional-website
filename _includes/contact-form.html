<form id="contact-form" action="https://formspree.io/f/xovnjogv" method="POST" novalidate>
  <div class="form-group">
    <label for="email">Your Email:</label>
    <input type="email" id="email" name="email" placeholder="you@example.com" required>
    <span class="error-message" id="email-error" aria-live="polite"></span>
  </div>

  <div class="form-group">
    <label for="message">Your Message:</label>
    <textarea id="message" name="message" rows="5" placeholder="Type your message here" required></textarea>
    <span class="error-message" id="message-error" aria-live="polite"></span>
  </div>

  <button type="submit">Send</button>

  <div id="form-status" role="status" aria-live="polite"></div>
</form>

<script>
const form = document.getElementById('contact-form');
const emailError = document.getElementById('email-error');
const messageError = document.getElementById('message-error');
const status = document.getElementById('form-status');

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  // Clear previous messages
  emailError.textContent = '';
  messageError.textContent = '';
  status.textContent = '';
  status.className = '';

  let valid = true;

  // Basic client-side validation
  if (!form.email.value.trim()) {
    emailError.textContent = 'Email is required';
    valid = false;
  } else if (!/\S+@\S+\.\S+/.test(form.email.value)) {
    emailError.textContent = 'Please enter a valid email';
    valid = false;
  }

  if (!form.message.value.trim()) {
    messageError.textContent = 'Message cannot be empty';
    valid = false;
  }

  if (!valid) return;

  // Send form via AJAX / fetch
  const formData = new FormData(form);

  try {
    const response = await fetch(form.action, {
      method: 'POST',
      body: formData,
      headers: { 'Accept': 'application/json' }
    });

    const data = await response.json();

    if (response.ok) {
      status.textContent = 'Thank you! Your message has been sent. I will respond via email shortly';
      status.className = 'alert-success';
      form.reset();
    } else {
      // Formspree may return errors
      if (data.errors) {
        data.errors.forEach(err => {
          if (err.field === 'email') emailError.textContent = err.message;
          if (err.field === 'message') messageError.textContent = err.message;
        });
      } else if (data.error) {
        status.textContent = data.error;
        status.className = 'alert-error';
      } else {
        status.textContent = 'Oops! Something went wrong.';
        status.className = 'alert-error';
      }
    }
  } catch (err) {
    status.textContent = 'Oops! Something went wrong.';
    status.className = 'alert-error';
  }
});
</script>
